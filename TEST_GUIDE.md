# Image Preprocessing Test Guide

## 测试图像预处理功能

现在应用已经实现了实际的图像预处理功能！以下是测试步骤：

### 1. 准备测试图片

准备一张包含文字的图片，可以是：
- 低对比度的文字图片
- 偏暗或偏亮的图片  
- 模糊的文字图片
- 手写或打印文档的照片

### 2. 测试基本OCR

1. 启动应用：`npm run tauri:dev`
2. 点击 **📁 Select Image** 选择测试图片
3. 直接点击 **🔍 Extract Text** 查看基础OCR结果
4. 记录识别准确率

### 3. 测试对比度调整

**场景**：低对比度图片

1. 选择测试图片
2. 点击 **⚙️ Show Advanced**
3. 将 **Contrast** 滑块调整到 1.5 - 2.0
4. 点击 **🔍 Extract Text**
5. 对比结果是否比基础OCR更准确

**预期**：文字与背景对比度增强，识别率提高

### 4. 测试亮度调整

**场景A**：过暗的图片

1. 选择偏暗的图片
2. 将 **Brightness** 滑块向右调整（0.2 - 0.4）
3. 执行OCR

**场景B**：过亮的图片

1. 选择过曝的图片
2. 将 **Brightness** 滑块向左调整（-0.2 - -0.4）
3. 执行OCR

**预期**：图片亮度调整后，文字更清晰

### 5. 测试锐度调整

**场景**：模糊的文字图片

1. 选择略微模糊的图片
2. 将 **Sharpness** 滑块调整到 1.5 - 2.0
3. 执行OCR

**预期**：文字边缘更清晰，识别率提高

**注意**：锐度过高可能引入噪点，建议适度调整

### 6. 测试自适应阈值

**场景**：光照不均匀的文档

1. 选择光照不均的文档照片
2. 勾选 **Use Adaptive Threshold**
3. 执行OCR

**预期**：将图片转为黑白二值图，在光照不均情况下效果显著

### 7. 组合测试

**场景**：复杂情况

尝试组合多个参数：
- Contrast: 1.3
- Brightness: 0.1
- Sharpness: 1.2
- Adaptive Threshold: ✓

观察组合调整的效果

### 8. 多语言测试

测试不同语言的识别：

1. **中文简体**
   - 选择: Chinese (Simplified)
   - 测试图片：简体中文文档

2. **中文繁体**
   - 选择: Chinese (Traditional)
   - 测试图片：繁体中文文档

3. **日文**
   - 选择: Japanese
   - 测试图片：日文文档

4. **其他语言**
   - 测试法语、德语、西班牙语等

### 9. 截图功能测试

1. 点击 **📸 Take Screenshot**
2. 使用鼠标框选屏幕上的文字区域
3. 等待自动OCR处理
4. 查看提取结果

### 10. 文本导出测试

**测试复制功能**
1. 执行OCR后
2. 点击 **📋 Copy**
3. 在其他应用粘贴验证

**测试保存功能**
1. 执行OCR后
2. 点击 **💾 Save**
3. 检查桌面上的 `ocr_result_*.txt` 文件

## 性能测试

### 处理时间对比

测试不同参数组合的处理时间：

1. **基础OCR**（无预处理）
2. **轻度处理**（仅调整对比度）
3. **重度处理**（所有参数 + 自适应阈值）

记录每种情况的处理时间差异

### 大图片测试

测试不同尺寸图片：
- 小图：< 500KB
- 中图：500KB - 2MB
- 大图：> 2MB

观察处理速度和内存占用

## 已知问题

1. **临时文件清理**
   - 预处理会在 `/tmp` 目录创建临时图片
   - 正常情况下会自动清理
   - 如果遇到错误可能需要手动清理

2. **极端参数**
   - 过高的对比度/锐度可能降低识别率
   - 建议在合理范围内调整

3. **处理时间**
   - 启用自适应阈值会显著增加处理时间
   - 大图片可能需要几秒钟

## 测试结果记录模板

```markdown
### 测试图片：[图片描述]

**基础OCR（无预处理）**
- 识别准确率：___%
- 处理时间：___秒
- 识别文本长度：___字符

**预处理参数**
- Contrast: ___
- Brightness: ___
- Sharpness: ___
- Adaptive Threshold: [是/否]
- Language: ___

**预处理后OCR**
- 识别准确率：___%
- 处理时间：___秒
- 识别文本长度：___字符
- 改进程度：___% 

**结论**
- 最佳参数组合：___
- 建议使用场景：___
```

## 对比原项目

与 Tesseract-macOS 原项目的图像处理功能对比：

| 功能 | 原项目 | Imagio | 实现状态 |
|------|--------|--------|---------|
| 基础对比度调整 | ✅ | ✅ | 完成 |
| 基础亮度调整 | ✅ | ✅ | 完成 |
| 锐度增强 | ✅ | ✅ | 完成（Unsharp Mask） |
| 自适应阈值 | ✅ | ✅ | 完成 |
| CLAHE | ✅ | ❌ | 待实现 |
| 双边滤波 | ✅ | ❌ | 待实现 |
| 倾斜校正 | ✅ | ❌ | 待实现 |

## 下一步优化

1. **添加预览功能**
   - 显示预处理前后的对比图
   - 实时预览参数调整效果

2. **参数预设**
   - 保存常用参数组合
   - 针对不同场景的预设（文档、截图、照片等）

3. **批处理**
   - 支持多图片批量处理
   - 使用相同参数处理多个文件

4. **高级算法**
   - CLAHE 对比度增强
   - 双边滤波降噪
   - 自动倾斜校正
